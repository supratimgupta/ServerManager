<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
</head>
<body>
    <div>
        <input type="text" placeholder="Enter process id" id="txtProcId" />
        <button id="btnEndProc">End proc</button>
        <span id="spnProcessCount"></span>
        <!--<input type="button" onclick="startChecking();" />-->
        <!--Script references. -->
        <!--Reference the jQuery library. -->
        <script src="Scripts/jquery-1.8.2.min.js"></script>
        <!--Reference the SignalR library. -->
        <script src="Scripts/jquery.signalR-2.2.1.min.js"></script>
        <!--Reference the autogenerated SignalR hub script. -->
        <script src="signalr/hubs"></script>
        <!--Add script to update the page and send messages.-->
        <script type="text/javascript">
            $(function () {
                // Declare a proxy to reference the hub.
                var chat = $.connection.notificationHub;
                // Create a function that the hub can call to broadcast messages.
                chat.client.broadcastServerDetails = function (serverDetails) {
                    //alert(serverDetails);
                    document.getElementById("spnProcessCount").innerHTML = serverDetails.Processes.length;
                    serverDetails = null;
                };
                $.connection.hub.start().done(function () {
                    //$.ajax({
                    //    url: 'api/server/callCurrentServer',
                    //    data: {  
                    //        format: 'json'
                    //    },
                    //    error: function (err) {
                    //        //debugger;
                    //        //alert(err);
                    //    },
                    //    dataType: 'jsonp',
                    //    success: function (data) {
                    //        debugger;
                    //        alert(data);
                    //    },
                    //    type: 'POST'
                    //});
                    alert('hub started');
                });
            });

            $(document).ready(function () {

                $("#btnEndProc").click(function () {
                    var processIdVal = $("#txtProcId").val();
                    $.ajax({
                        url: 'api/server/stopProcess',
                        data: { "": processIdVal },
                        error: function (err) {
                            //debugger;
                            //alert(err);
                        },
                        dataType: 'jsonp',
                        success: function (data) {
                            debugger;
                            alert(data);
                        },
                        type: 'POST'
                    });;

                });

            });

        </script>
    </div>
</body>
</html>
